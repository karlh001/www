<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://karlhunter.co.uk/defiant/db/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Database - DEFIANT-FG</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Database";
        var mkdocs_page_input_path = "db.md";
        var mkdocs_page_url = "/defiant/db/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> DEFIANT-FG
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../requirements/">Requirements</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../download/">Download</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../run/">Run</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../flags/">Flags</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Database</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#about">About</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#location">Location</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#portability">Portability</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#structure">Structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#file-name-limitations">File Name Limitations</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#remove-entries">Remove Entries</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#find-duplicates">Find Duplicates</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../errors/">Errors</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../release_notes_1/">Release Notes 1.x</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../contact/">Contact</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../bugs/">Bugs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../credits/">Credits</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../donate/">Donate</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">DEFIANT-FG</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Database</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="database">Database</h1>
<h2 id="about">About</h2>
<p>DEFIANT-FG stores your file hashes into a database (db) file named <code>dfg.db</code>. It's formatted to SQLite. </p>
<h2 id="location">Location</h2>
<p>By default, db file is stored in the root of the given directory; for example, if you run on <code>/mnt/usb/Pictures</code> the db file will be located <code>/mnt/usb/Pictures/dfg.db</code>. Any sub folders will be included in the hash database.</p>
<p>You can specify your own db location with name of the database file. To do this, use the <code>-db</code> flag, example:</p>
<pre><code>dfg -db /path/to/db.sql -d /path/to/files/
</code></pre>
<h2 id="portability">Portability</h2>
<p>You are encouraged to keep a back-up of the database file. As long as you restore to the root of the original directory (or specify the exact location) it will work, even though the full path changes. For example, you can move the Pictures to: <code>/mnt/usb2/Pictures</code>; in fact, the picture directory name can be changed too.</p>
<h2 id="structure">Structure</h2>
<ul>
<li>dfg.db<ul>
<li>objects [table]<ul>
<li>ID_objects [column] (auto increment)</li>
<li>path [column] (subfolder1/filename)</li>
<li>hash [column] (SHA-256)</li>
<li>ts (time stamp) [column] (YYYYMMDDHHMMSS)</li>
<li>enabled [column] default 1</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="file-name-limitations">File Name Limitations</h2>
<p>The database will not accept an apostrophes or <code>&lt;!</code> in the filename; if present in a file name, these will be replaced with a tag before storing in the database. The apostrophe will become <code>xAPOSx</code> and the less than bracket <code>&lt;!</code> will become <code>xBRACKx</code>.</p>
<h2 id="remove-entries">Remove Entries</h2>
<p><em>as of version 1.3</em></p>
<p>If you have removed an object and no longer wish it to remain in the database, you can remove it using follow commands.</p>
<p>First, you will need to determine the database ID. This will be printed in a log or terminal output after a scan:</p>
<pre><code>2024/03/02 16:19:46 missing: /Interesting_Document.pdf ID: 919
</code></pre>
<p>Copy / note the ID of the missing object, in this case 919.</p>
<pre><code>dfg -data del -db /path/to/dfg.db
</code></pre>
<p>The database tool will ask for ID of record to delete; this is this ID given in terminal output or log file, in this example it's 919.</p>
<pre><code>Database tool using the following database: /path/to/dfg.db

Type ID of record to delete:
919
File entry to delete: /Interesting_Document.pdf
Correct? [y/n]
y
Delete request completed
</code></pre>
<p>The entry will remain in the database but will be disabled, which will not reduce size of the database file. Future releases will have a clean-up feature.</p>
<h2 id="find-duplicates">Find Duplicates</h2>
<p>This will search database file for duplicated files with the same hashes. The command will return occurrences (2) and name of one of the files.</p>
<pre><code>dfg -data same -db /path/to/dfg.db
</code></pre>
<p>You must specify database file.</p>
<p>Example output:</p>
<pre><code>(2) /pictures/photo1.jpg
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../flags/" class="btn btn-neutral float-left" title="Flags"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../errors/" class="btn btn-neutral float-right" title="Errors">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../flags/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../errors/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
